<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP32-C3 BLE LED Control</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
  h1 { text-align: center; }
  .led-control { margin: 20px 0; }
  label { display: block; margin-bottom: 5px; font-weight: bold; }
  input[type="range"] { width: 100%; }
</style>
</head>
<body>
<h1>ESP32-C3 BLE LED Control</h1>

<button id="connectBtn">Connect to ESP32</button>

<div class="led-control">
  <label for="redSlider">Red LED</label>
  <input type="range" id="redSlider" min="0" max="255" value="0">
</div>

<div class="led-control">
  <label for="yellowSlider">Yellow LED</label>
  <input type="range" id="yellowSlider" min="0" max="255" value="0">
</div>

<div class="led-control">
  <label for="greenSlider">Green LED</label>
  <input type="range" id="greenSlider" min="0" max="255" value="0">
</div>

<script>
let device;
let server;
let service;
let redChar, yellowChar, greenChar;

const SERVICE_UUID = 'FF00';
const RED_UUID = 'FF01';
const YELLOW_UUID = 'FF02';
const GREEN_UUID = 'FF03';

async function connectBLE() {
  try {
    device = await navigator.bluetooth.requestDevice({
      filters: [{ services: [SERVICE_UUID] }]
    });
    server = await device.gatt.connect();
    service = await server.getPrimaryService(SERVICE_UUID);

    redChar = await service.getCharacteristic(RED_UUID);
    yellowChar = await service.getCharacteristic(YELLOW_UUID);
    greenChar = await service.getCharacteristic(GREEN_UUID);

    alert('Connected to ESP32-C3!');
  } catch (error) {
    console.error(error);
    alert('Failed to connect: ' + error);
  }
}

function writeLED(char, value) {
  if (!char) return;
  const data = new Uint8Array([value]);
  char.writeValue(data).catch(err => console.error(err));
}

document.getElementById('connectBtn').addEventListener('click', connectBLE);
document.getElementById('redSlider').addEventListener('input', e => writeLED(redChar, parseInt(e.target.value)));
document.getElementById('yellowSlider').addEventListener('input', e => writeLED(yellowChar, parseInt(e.target.value)));
document.getElementById('greenSlider').addEventListener('input', e => writeLED(greenChar, parseInt(e.target.value)));
</script>
</body>
</html>
